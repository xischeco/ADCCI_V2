!function(t){var i="2ca692cb-bdb2-4c9d-a3b5-917b3656c46a",n="ea27aca5-432f-424a-b000-26ba5f8ae60a";function e(t,i){return-1!==t.toLowerCase().indexOf(i.toLowerCase(),t.length-i.length)}function o(t){var i=t.name;if(!e(i,"value")){var n=i.toLowerCase().indexOf("fields[");return i.substring(0,n+"fields[".length+3)+"Value"}return i}function a(i){var n;if("checkbox"===i.type||"radio"===i.type){var e=t(i).closest("form").find("input[name='"+i.name+"']");e.length>1?(n=[],e=e.not(":not(:checked)"),t.each(e,function(){n.push(t(this).val())})):n=i.checked?"1":"0"}else n=t(i).val();return n&&"[object Array]"===Object.prototype.toString.call(n)&&(n=n.join(",")),n}t.fxbFormTracker=function(i,n){this.el=i,this.$el=t(i),this.options=t.extend({},t.fxbFormTracker.defaultOptions,n),this.init()},t.fxbFormTracker.parse=function(i){t(i).track_fxbForms()},t.extend(t.fxbFormTracker,{defaultOptions:{formId:null,sessionId:null,fieldId:null,fieldValue:null,duration:null},prototype:{init:function(){this.options.duration=0,this.options.formId=this.$el.attr("data-sc-fxb")},startTracking:function(){var t,i,n;this.options.sessionId=(t=this.$el,i=t[0].id,n=i.slice(0,-(i.length-i.lastIndexOf("_")-1))+"FormSessionId",t.find("input[type='hidden'][id=\""+n+'"]').val());var e=this,o=this.$el.find("input:not([type='submit']), select, textarea"),a=o.filter("[data-sc-tracking='True'], [data-sc-tracking='true']");a.length&&(o.not(a).bind("focus",function(){e.onFocusField(this)}),a.bind("focus",function(){e.onFocusField(this,!0)}).bind("blur change",function(){e.onBlurField(this)}))},onFocusField:function(i,n){if(n){var e=o(i);this.options.fieldId!==e&&(this.options.fieldId=e,this.options.duration=t.now(),this.options.fieldValue=a(i))}else this.options.fieldId=""},onBlurField:function(n){var s,r,d,l=o(n),c=t.now();if(!e(l,"value")){var f=(s=this.$el,d=(r=l).slice(0,-(r.length-r.lastIndexOf(".")-1))+"Value",s.find('input[name="'+d+'"]')[0]);if(!f)return;n=f}var u=this.options.duration?Math.round((c-this.options.duration)/1e3):0,h=a(n),p=this.options.fieldId!==l;if(p&&(this.options.fieldId=l,this.options.duration=t.now(),u=0),p||this.options.fieldValue!==h){this.options.fieldValue=h;var b=function(i){return t(i).attr("data-sc-field-name")}(n),m=this.buildEvent(l,b,i,u),v=this.$el.data("validator"),k=[];v&&!v.element(n)&&(k=this.checkClientValidation(n,b,v,u)),this.trackEvents(t.merge([m],k))}},buildEvent:function(i,n,e,o){var a=i.slice(0,-5)+"ItemId";return i=t('input[name="'+a+'"]').val(),{formId:this.options.formId,sessionId:this.options.sessionId,eventId:e,fieldId:i,duration:o,fieldName:n}},checkClientValidation:function(i,e,o,a){var s=this,r=[];return t.each(o.errorMap,function(t){if(t===i.name){var o=s.buildEvent(t,e,n,a);r.push(o)}}),r},trackEvents:function(i){t.ajax({type:"POST",url:"/fieldtracking/register",data:JSON.stringify(i),dataType:"json",contentType:"application/json"})}}}),t.fn.track_fxbForms=function(i){return this.each(function(){var n=t.data(this,"fxbForms.tracking");n?n.startTracking():(n=new t.fxbFormTracker(this,i),t.data(this,"fxbForms.tracking",n),n.startTracking())})},t(document).ready(function(){t("form[data-sc-fxb]").track_fxbForms()})}(jQuery);