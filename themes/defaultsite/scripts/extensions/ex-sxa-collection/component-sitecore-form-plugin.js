!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";var e,n={errorElement:"span",errorClass:"input-error",inputWrapper:".input-box",validClass:"input-success",errorBlock:".error-block",validCssClass:"is-valid",invalidCssClass:"is-invalid",captchaWrapper:".captcha-wrapper",captchaTheme:"light",onValidateError:jQuery.noop(),onCaptchaValidate:jQuery.noop(),onInit:jQuery.noop(),beforeSend:jQuery.noop(),afterSend:jQuery.noop(),sending:jQuery.noop(),onSendSuccess:jQuery.noop(),onSendError:jQuery.noop(),dialogDismissed:jQuery.noop()},o="ar-ae"==t("html").attr("lang").toLocaleLowerCase();function a(o,a){e=this,this.$window=t(window),this.$document=t(document),this.$form=t(o),this.options=t.extend({},n,a),this.onInit=this.options.onInit||jQuery.noop(),this.sending=this.options.sending||jQuery.noop(),this.beforeSend=this.options.beforeSend||jQuery.noop(),this.afterSend=this.options.afterSend||jQuery.noop(),this.onSendSuccess=this.options.onSendSuccess||jQuery.noop(),this.onSendError=this.options.onSendError||jQuery.noop(),this.onCaptchaValidate=this.options.onCaptchaValidate||jQuery.noop(),this.dialogDismissed=this.options.dialogDismissed||jQuery.noop(),this.init()}return a.prototype.showError=function(e){return t(e).parents(this.options.inputWrapper).replaceClass(this.options.validCssClass,this.options.invalidCssClass)},a.prototype.showSuccess=function(e){return t(e).parents(this.options.inputWrapper).replaceClass(this.options.invalidCssClass,this.options.validCssClass)},a.prototype.replaceClass=function(e,n){return t(element).removeClass(e).addClass(n)},a.prototype.init=function(){this.placeCaptcha(),null!=jQuery.fn.validate?this.initValidate():this.$form.on("submit",function(t){t.preventDefault(),e.submit()}),null!=jQuery.fn.validate&&this.resetForm(),this.onInit&&"function"==typeof this.onInit&&this.onInit()},a.prototype.placeCaptcha=function(){document.addEventListener("grecaptcha-loaded",function(){if(e.$form.find(e.options.captchaWrapper).length){e.captchaWrapper=e.$form.find(e.options.captchaWrapper);let n=e.captchaWrapper.data("name"),o=e.captchaWrapper.data("sitekey"),a=e.captchaWrapper.data("size"),r=t.guid++;e.captchaMsg=e.captchaWrapper.data("msgRequired"),e.captchaID="captcha-div-"+r,e.captchaInputID="captcha-input-"+r,t("<div/>",{id:e.captchaID}).appendTo(e.captchaWrapper),e.captchaInput=t("<input />",{name:n,type:"hidden",id:e.captchaInputID}),e.captchaInput.appendTo(e.captchaWrapper),t("<div/>",{class:e.options.errorBlock.replace(".","")+" my-2"}).appendTo(e.captchaWrapper),e.captchaWidget=grecaptcha.render(e.captchaID,{sitekey:o,callback:e.captchaCallback,theme:e.options.captchaTheme,size:a})}})},a.prototype.getCaptcha=function(){return this.captchaWidget},a.prototype.hasCaptcha=function(){return void 0!==this.captchaWidget},a.prototype.resetCaptcha=function(){e.hasCaptcha()&&(grecaptcha.reset(e.getCaptcha()),e.captchaInput.val(""))},a.prototype.getCaptchaID=function(){return this.captchaID},a.prototype.captchaCallback=function(t){return e.captchaInput.val(t),e.onCaptchaValidate(t)?e.send():jQuery.noop()},a.prototype.initValidate=function(){this.$form.validate({lang:o?"ar":"en",errorElement:this.options.errorElement,errorClass:this.options.errorClass,validClass:this.options.validClass,ignore:".validation-ignore",errorPlacement:function(t,n){t.appendTo(n.parents(e.options.inputWrapper).find(e.options.errorBlock)),e.showError(n)},onfocusout:function(n){t(n).valid()?e.showSuccess(n):e.showError(n)},onkeyup:function(n){t(n).valid()?e.showSuccess(n):e.showError(n)},success:function(t){e.showSuccess(t)},submitHandler:function(){e.submit()}})},a.prototype.resetForm=function(){e.$form.on("reset",function(){e.$form.find("[data-toggler]").prop("checked",!1).change(),e.$form.find(".is-valid , .is-invalid").removeClass("is-valid").removeClass("is-invalid"),e.$form.data("validator").resetForm()})},a.prototype.getFormData=function(){var e=new FormData,n=this.$form.find("[name]");for(var o in(n=n.toArray().reduce(function(t,e){return t[e.name]=(t[e.name]||[]).concat(e),t},{})).pageurl=[{value:location.href}],n){let a=n[o],r="";if(a[0]&&"checkbox"!=a[0].type&&"radio"!=a[0].type)a.length>0&&(r=a[0].value);else{let e=a.filter(function(e){return t(e).is(":checked")});e.length&&(1==a.length?r=t(a[0]).is(":checked"):a.length>1&&(r="radio"==a[0].type?e.find(function(e){return t(e).is(":checked")}).value:e.map(function(t){return t.value})))}!e.get(o)&&null!=r&""!=r&&e.append(o,r)}return e},a.prototype.submit=function(){e.hasCaptcha()?grecaptcha.execute(e.getCaptcha()):e.send()},a.prototype.send=function(){e.beforeSend&&"function"==typeof e.beforeSend&&e.beforeSend();try{var n=e.$form.attr("action");t.ajax({processData:!1,contentType:!1,type:"POST",url:n,data:e.getFormData(),success:function(t){t?e.onSendSuccess(t):e.onSendError(new Error("Failed to get response")),e.afterSend&&"function"==typeof e.afterSend&&e.afterSend(),e.resetCaptcha()},error:function(t){e.afterSend&&"function"==typeof e.afterSend&&e.afterSend(),e.onSendError(t),e.resetCaptcha()}}),e.sending&&"function"==typeof e.sending&&e.sending()}catch(t){e.onSendError&&"function"==typeof e.onSendError&&(e.onSendError(t),e.resetCaptcha())}},t.fn.FormPlugin=function(e){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var o=t(this),r=o.data("FormPlugin");if(!r){let t=new a(this,e);o.data("FormPlugin",r=t)}"string"==typeof e&&r[e].apply(r,n)})},"Error Initializing happiness requester"});